(()=>{"use strict";var e,t="";function o(){linkSchemeStyle.href=t+"./css/light.css",e=!0}function n(){linkSchemeStyle.href=t+"./css/dark.css",e=!1}class r{constructor(){return localStorage||console.log("Local storage not supported."),this.fetchVideoSrcFromLocalStorage=function(){return new Promise(((e,t)=>{localStorage||t("Not support action");const o=localStorage.getItem("video");if(!o)return t("No such item in local storage.");try{e(JSON.parse(o))}catch(e){console.log("Data in local storage not available."),t(e)}}))},this.removeVideoSrcFromLocalStorage=function(){localStorage&&localStorage.removeItem("video")},this.addVideoSrcToLocalStorage=function(e){localStorage&&localStorage.setItem("video",JSON.stringify(e))},this.fetchVideoSrcFromSameSite=async function(){return(await fetch(rootPath+"data/video.json",{method:"GET"})).json()},this.fetchVideoSrcFromGitHub=async function(){return(await fetch("https://raw.githubusercontent.com/TheVeryDarkness/sport_data/main/video.json",{method:"GET"})).json()},this}}var c=[[],[],[],[],[]],s={};function a(e){const t=document.getElementById("loadStatus");t?t.value=e?"刷新":"重试":console.error("Name an element to show the status of loading.")}function l(e="全选"){return{value:e,sub:[]}}function i(e,t){return new Array(l("全选")).concat(function(e,t){var o=new Array;for(const n of function(e,t){return 0===t?e:new Array(e[t])}(e,t))n.sub?o=o.concat(n.sub):console.log("Node '",n.value,"' miss property 'sub'.");return o}(e,t))}var d=[document.getElementById("s0"),document.getElementById("s1"),document.getElementById("s2"),document.getElementById("s3"),document.getElementById("s4")],u=()=>{console.log("Not specified.")};function m(e){!function(e){const t=new r;(Promise.any?Promise.any([t.fetchVideoSrcFromLocalStorage(),t.fetchVideoSrcFromSameSite(),t.fetchVideoSrcFromGitHub()]):t.fetchVideoSrcFromLocalStorage().catch((e=>(console.log(e),t.fetchVideoSrcFromSameSite()))).catch((e=>(console.log(e),t.fetchVideoSrcFromGitHub()))).catch((e=>{console.log(e),alert("Can't load by any mean.")}))).then((e=>{s=e,h(-1),a(!0),t.addVideoSrcToLocalStorage(s),console.log("Video data stored.")})).catch((e=>{console.error(e),a(!1),t.removeVideoSrcFromLocalStorage(),console.log("Local storage removed. Refresh to reload."),alert("Failed to load video data properly by any means.")}))}(),e?u=e:console.error("Callback not available.")}function f(e,t){!function(e,t){e.options.length=t.length;for(const o in t)e.options[o].text=t[o].value}(e,t)}function h(e){switch(e>0&&0==d[e-1].selectedIndex&&function(e){switch(e){case 4:g(d[3],d[4],c[3]);case 3:g(d[2],d[3],c[2]);case 2:g(d[1],d[2],c[1]);case 1:g(d[0],d[1],c[0])}}(e),e){case-1:c[0]=new Array(l()).concat(s.root),f(d[0],c[0]);case 0:c[1]=i(c[0],d[0].selectedIndex),f(d[1],c[1]),d[1].selectedIndex=0;case 1:c[2]=i(c[1],d[1].selectedIndex),f(d[2],c[2]),d[2].selectedIndex=0;case 2:c[3]=i(c[2],d[2].selectedIndex),f(d[3],c[3]),d[3].selectedIndex=0;case 3:c[4]=i(c[3],d[3].selectedIndex),f(d[4],c[4]),d[4].selectedIndex=0;case 4:u();break;default:console.error("Unexpected index ",e)}}function g(e,t,o){var n=1,r=0;for(const e of o){if((n+=e.sub.length)>t.selectedIndex)break;++r}e.selectedIndex=r}var v=0,p=NaN;const I="javascript:void(0)",b="about:blank";var y="html5",x={src:"",from:"",origin:b};function S(e,t){y=t,x=e,"html5"==t?(sourceVideo.src=e.src,F("video"),video.load(),video.currentTime=v,video.addEventListener("timeupdate",V)):"player"==t?("bilibili"==e.from?embededFrame.src=e.frame+"&high_quality=1&t="+v:"vqq"==e.from?embededFrame.src=e.frame+"&show1080p=1&starttime="+v:"youku"==e.from?embededFrame.src=e.frame+"?starttime="+v+"&endtime="+p:(embededFrame.src=e.frame,console.log("Unrecognized video source: '",e.from,"'")),F("iframe")):"page"==t?(embededFrame.src=e.origin,F("iframe")):console.error("Unrecognized mode '",t,"'.")}function w(e){if(originVideoURL.href=e.src?e.src:I,originWebpage.href=e.origin?e.origin:b,e.src)S(e,"html5");else if(e.frame)S(e,"player");else{if(!e.origin)return!1;S(e,"page")}return!0}function N(e){if(e.range){if(e.range[0]&&e.range[1]){const t=e.range[0],o=e.range[1];return v=t,p=o,!0}console.log("Node '",e.value,"' has a illegal value for property 'range'")}return!1}function V(){video.currentTime>=p&&(video.pause(),video.removeEventListener("timeupdate",V))}function F(e){"video"==e?(video.style.display="block",embededFrame.style.display="none"):"iframe"==e?(video.style.display="none",embededFrame.style.display="block"):console.error("Unrecognized mode '",e,"'.")}function T(){v=0,p=NaN,originVideoURL.href=I,sourceVideo.src="",originWebpage.href=b,embededFrame.src=b,video.load()}function A(e){return e&&e.comment?e.comment[0].content:""}function E(e){return Math.floor(e/3600)+":"+Math.floor(e%3600/60)+":"+e%60}function k(){T(),0!==d[4].selectedIndex&&N(c[4][d[4].selectedIndex])||0!==d[3].selectedIndex&&N(c[3][d[3].selectedIndex])||0!==d[2].selectedIndex&&N(c[2][d[2].selectedIndex])||(displayVideoTimeRange.innerText=""),0!==d[4].selectedIndex&&w(c[4][d[4].selectedIndex])||0!==d[3].selectedIndex&&w(c[3][d[3].selectedIndex])||0!==d[2].selectedIndex&&w(c[2][d[2].selectedIndex])||T();for(let e=0;e<c.length;e++){const t=document.getElementById("i"+String(e)),o=c[e],n=d[e].selectedIndex;0!==n&&o[n]&&(t.innerText=o[n].value+": "+A(o[n])),t.hidden=!t.innerText}displayVideoTimeRange.innerText=E(v)+", "+E(p)}const L=[[["原地8字舞龙","行进8字舞龙","单跪舞龙","套头舞龙","搁脚舞龙","扯旗舞龙","靠背舞龙","横移(跳)步舞龙","起伏8字舞龙"],["直线行进","曲线行进","走(跑)圆场","滑步行进","起伏行进","单侧起伏小圆场","矮步跑圆场","直线(曲线、圆场)行进越障碍"],["穿龙尾","越龙尾","首尾穿(越)肚"],["龙翻身"],["龙门造型","塔盘造型","尾盘造型","曲线造型","龙出宫造型","蝴蝶盘花造型","组字造型","龙舟造型","螺丝结顶造型","卧(垛)龙造型"]],[["原地快速8字舞龙","行进快速8字舞龙","跪步行进快舞龙","抱腰舞龙","绕身舞龙","双人换位舞龙","快舞龙磨转","连续抛接龙头横移(跑)步舞龙"],["快速曲线起伏行进","快速顺逆连续跑圆场","快速矮步跑圆场越障碍","快速跑斜圆场","骑肩双杆起伏行进"],["龙穿身","龙脱衣","龙戏尾","连续腾越行进","腾身穿尾","穿尾越龙身","卧龙飞腾","穿八五节","首(尾)穿花缠身行进"],["快速逆(顺)向跳龙行进(2次以上)","连续游龙跳龙(2次以上)","大立圆螺旋行进(3次以上)"],["上肩高塔造型自转一周","龙尾高翘寻珠、追珠","首尾盘柱","龙翻身接滚翻成造型","单臂侧手翻接滚翻成造型"]],[["跳龙接一蹲一躺快舞龙","跳龙接摇船快舞龙","跳龙接直躺快舞龙","依次滚翻接单跪快舞龙","挂腰舞龙(两人一组)","K式舞龙(3人一组)","站腿舞龙(两人一组)","双杆舞龙(一人持两杆)"],["站肩平盘起伏(二周以上)","直线后倒、鲤鱼打挺接擎龙行进"],["快速连续穿越行进(3次以上)","连续穿越腾越行进(4次以上)"],["快速连续斜盘跳龙(3次以上)","快速连续螺旋跳龙(4次以上)","快速连续螺旋跳龙磨转(6次以上)","快速左右螺旋跳龙(左右各3次以上)","快速连续磨盘跳龙(3次以上)"],["大横8字花慢行进(成型4次以上)","坐肩后仰成平盘起伏旋转(一周以上)"]]];3!=L.length&&console.log("Debug failed! There should be 3 levels.");for(const e of L)5!=e.length&&console.log("Debug failed! There should be 5 categories.");var R=new Array;function B(){var e=new Array;for(const t of arguments)e.push(t.value.toString());return e}function D(e){if(null!=e){searchResults.options.length=0,R.length=0;for(const t in c[0]){if(0==t)continue;const o=c[0][t];o.value.match(e)&&(M(searchResults,B(o)),R.push(new Array(t,0,0,0,0)));for(const n in o.sub){const r=o.sub[n];r.value.match(e)&&(M(searchResults,B(r,o)),R.push(new Array(t,Number(n)+1,0,0,0)));for(const c in r.sub){const s=r.sub[c];s.value.match(e)&&(M(searchResults,B(s,r,o)),R.push(new Array(t,Number(n)+1,Number(c)+1,0,0)));for(const a in s.sub){const l=s.sub[a];l.value.match(e)&&(M(searchResults,B(l,s,r,o)),R.push(new Array(t,Number(n)+1,Number(c)+1,Number(a)+1,0)));for(const i in l.sub){const d=l.sub[i];d.value.match(e)&&(M(searchResults,B(d,l,s,r,o)),R.push(new Array(t,Number(n)+1,Number(c)+1,Number(a)+1,Number(i)+1)))}}}}}}}function M(e,t){e.options.length=e.options.length+1,e.options[e.options.length-1].text=t}function U(){if(-1!==a1.selectedIndex&&-1!==a2.selectedIndex){a3.options.length=0;for(const e of L[a1.selectedIndex][a2.selectedIndex])M(a3,e)}}t="",function(){if(window.matchMedia("(prefers-color-scheme: dark)").matches)n();else if(window.matchMedia("(prefers-color-scheme: light)").matches)o();else if(window.matchMedia("(prefers-color-scheme: no-preference)").matches)o();else{var e=new Date;e.getHours()>=22||e.getHours()<=6?n():o()}}(),m(k),U();for(let e=0;e<d.length;e++)d[e].onchange=()=>h(e);document.getElementById("chooseItem").onsubmit=e=>{e.preventDefault(),m(k)},document.getElementById("playMode").onclick=function(){const e=["html5","player","page"],t=x,o=e.indexOf(y);S(t,e[(o+1)%e.length])},document.getElementById("chooseAction").onsubmit=e=>{var t;e.preventDefault(),a3.selectedIndex<0?U():(t=a3.options[a3.selectedIndex].text,textSearchInAll.value=t,D(t))},document.getElementById("searchName").onsubmit=e=>{e.preventDefault(),D(textSearchInAll.value)},textSearchInAll.oninput=()=>D(textSearchInAll.value),searchResults.onchange=function(){var e=R[searchResults.selectedIndex];s0.selectedIndex=e[0],c[1]=i(c[0],e[0]),f(d[1],c[1]),d[1].selectedIndex=e[1],c[2]=i(c[1],e[1]),f(d[2],c[2]),d[2].selectedIndex=e[2],c[3]=i(c[2],e[2]),f(d[3],c[3]),d[3].selectedIndex=e[3],c[4]=i(c[3],e[3]),f(d[4],c[4]),d[4].selectedIndex=e[4],k()},lightIndication.onclick=function(){e?(n(),lightIndication.innerText="一熄灯一切被纪念"):(o(),lightIndication.innerText="一开灯一切变妄念")}})();