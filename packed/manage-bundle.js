(()=>{"use strict";var e,t="";function o(){linkSchemeStyle.href=t+"./css/light.css",e=!0}function n(){linkSchemeStyle.href=t+"./css/dark.css",e=!1}class c{constructor(){return localStorage||console.log("Local storage not supported."),this.fetchVideoSrcFromLocalStorage=function(){return new Promise(((e,t)=>{localStorage||t("Not support action");const o=localStorage.getItem("video");if(!o)return t("No such item in local storage.");try{e(JSON.parse(o))}catch(e){console.log("Data in local storage not available."),t(e)}}))},this.removeVideoSrcFromLocalStorage=function(){localStorage&&localStorage.removeItem("video")},this.addVideoSrcToLocalStorage=function(e){localStorage&&localStorage.setItem("video",JSON.stringify(e))},this.fetchVideoSrcFromSameSite=async function(){return(await fetch(rootPath+"data/video.json",{method:"GET"})).json()},this.fetchVideoSrcFromGitHub=async function(){return(await fetch("https://raw.githubusercontent.com/TheVeryDarkness/sport_data/main/video.json",{method:"GET"})).json()},this}}var r=[[],[],[],[],[]],a={};function l(e){const t=document.getElementById("loadStatus");t?t.value=e?"刷新":"重试":console.error("Name an element to show the status of loading.")}function s(e="全选"){return{value:e,sub:[]}}function i(e,t){return new Array(s("全选")).concat(function(e,t){var o=new Array;for(const n of function(e,t){return 0===t?e:new Array(e[t])}(e,t))n.sub?o=o.concat(n.sub):console.log("Node '",n.value,"' miss property 'sub'.");return o}(e,t))}var d=[document.getElementById("s0"),document.getElementById("s1"),document.getElementById("s2"),document.getElementById("s3"),document.getElementById("s4")],u=()=>{console.log("Not specified.")};function m(e){!function(e){const t=new c;(Promise.any?Promise.any([t.fetchVideoSrcFromLocalStorage(),t.fetchVideoSrcFromSameSite(),t.fetchVideoSrcFromGitHub()]):t.fetchVideoSrcFromLocalStorage().catch((e=>(console.log(e),t.fetchVideoSrcFromSameSite()))).catch((e=>(console.log(e),t.fetchVideoSrcFromGitHub()))).catch((e=>{console.log(e),alert("Can't load by any mean.")}))).then((e=>{a=e,f(-1),l(!0),t.addVideoSrcToLocalStorage(a),console.log("Video data stored.")})).catch((e=>{console.error(e),l(!1),t.removeVideoSrcFromLocalStorage(),console.log("Local storage removed. Refresh to reload."),alert("Failed to load video data properly by any means.")}))}(),e?u=e:console.error("Callback not available.")}function h(e,t){!function(e,t){e.options.length=t.length;for(const o in t)e.options[o].text=t[o].value}(e,t)}function f(e){switch(e>0&&0==d[e-1].selectedIndex&&function(e){switch(e){case 4:g(d[3],d[4],r[3]);case 3:g(d[2],d[3],r[2]);case 2:g(d[1],d[2],r[1]);case 1:g(d[0],d[1],r[0])}}(e),e){case-1:r[0]=new Array(s()).concat(a.root),h(d[0],r[0]);case 0:r[1]=i(r[0],d[0].selectedIndex),h(d[1],r[1]),d[1].selectedIndex=0;case 1:r[2]=i(r[1],d[1].selectedIndex),h(d[2],r[2]),d[2].selectedIndex=0;case 2:r[3]=i(r[2],d[2].selectedIndex),h(d[3],r[3]),d[3].selectedIndex=0;case 3:r[4]=i(r[3],d[3].selectedIndex),h(d[4],r[4]),d[4].selectedIndex=0;case 4:u();break;default:console.error("Unexpected index ",e)}}function g(e,t,o){var n=1,c=0;for(const e of o){if((n+=e.sub.length)>t.selectedIndex)break;++c}e.selectedIndex=c}var S={};function p(e=d.length){!function(e){S=e;const t=document.getElementById("nodeProperties");if(t){for(;t.childNodes.length>0;)t.removeChild(t.lastChild);var o=0;for(const r in e)if(e.hasOwnProperty(r)){++o;const l=e[r],s=document.createElement("li"),i=document.createElement("label");i.innerText=r,i.for="display-li-"+o;const d=document.createElement("p");var n;if(d.className="sub","sub"!=r)(n=document.createElement("input")).value=l,n.onchange=e=>{S[r]=e.target.value,console.log(JSON.stringify(a))};else{var c=[];for(const e of l)c.push(e.value);n=document.createTextNode(c)}n.id="display-li-"+o,d.appendChild(n),i.appendChild(d),s.appendChild(i),t.appendChild(s)}}else console.error("No display target.")}(function(e=d.length){d.length<e&&(console.error("Out of Range"),e=d.length);var t=-1;for(let o=0;o<e;o++)d[o].selectedIndex>0&&(t=o);return t>=0?r[t][d[t].selectedIndex]:{}}(e))}t="../",function(){if(window.matchMedia("(prefers-color-scheme: dark)").matches)n();else if(window.matchMedia("(prefers-color-scheme: light)").matches)o();else if(window.matchMedia("(prefers-color-scheme: no-preference)").matches)o();else{var e=new Date;e.getHours()>=22||e.getHours()<=6?n():o()}}(),m(p);for(let e=0;e<d.length;e++)d[e].onchange=()=>f(e);lightSwitch.onclick=function(){e?(n(),lightIndication.innerText="一熄灯一切被纪念"):(o(),lightIndication.innerText="一开灯一切变妄念")},document.getElementById("selectItem").onsubmit=e=>{e.preventDefault(),m(p)},document.getElementById("generateJSON").onclick=function(){var e,t;result.textContent=JSON.stringify(a,null,1),e=result.textContent,(t=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download","result.json"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}})();